<html>
    <head>
    </head>
    <body>
        <article class="repertoire" >
            <h1>Stats API data</h1>
            <button class="loader" x-data="https://raw.githubusercontent.com/marcoamarooliveira/sampledata/master/20200813_stats_api/v_usage.json" x-gene="v">Load v_usage</button>
            <button class="loader" x-data="https://raw.githubusercontent.com/marcoamarooliveira/sampledata/master/20200813_stats_api/d_usage.json" x-gene="d">Load d_usage</button>
            
            <button class="loader" x-data="https://raw.githubusercontent.com/marcoamarooliveira/sampledata/master/20200813_stats_api/d_usage.json" x-gene="x">Throw error</button>

            <div id="usage_stats_api_data" class="iRVis" style="min-width: 310px; height: 400px; margin: 0 auto">Show sample data here</div>
        </article>

        <script src="lib/jquery-3.5.1.min.js"></script>
        <script src="http://code.highcharts.com/highcharts.js"></script>
        <script src="http://code.highcharts.com/modules/exporting.js"></script>
        <script src="https://code.highcharts.com/modules/data.js"></script>
        <script src="https://code.highcharts.com/modules/drilldown.js"></script>

        <script src="iRplusCharts.js"></script>

        <script>
            function redrawChart(gene, url){
                $.get(url, function(data){
                    let prop = new IRplusProperties().setId("usage_stats_api_data").setXLabel("Category");
                    console.log(prop);
                    
                    let d = new DataSeries(gene);
                    d.setData(data);
                    console.log("---------------------------");
                    console.log(d);
                    console.log("---------------------------");
                    
                    let chart = new IRplusChart(prop);
                    chart.setDataSeries(d);
                    chart.plot();
                    console.log(chart);
                });
            }

            $(function () {
                $('.loader').click(function(){
                    redrawChart($(this).attr('x-gene'), $(this).attr('x-data'));
                });
                
                if (Highcharts) {
                    console.log('Highcharts available')
                }
                if (Highcharts._modules.hasOwnProperty("Extensions/Drilldown.js")) {
                    console.log('Drilldown module available')
                }
                if (Highcharts._modules.hasOwnProperty("Extensions/Exporting.js")) {
                    console.log('Exporting module available')
                }
                if (Highcharts._modules.hasOwnProperty("Extensions/Data.js")) {
                    console.log('Data module available')
                }
            });
        </script>
    </body>
</html>